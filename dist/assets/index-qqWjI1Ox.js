(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=o(i);fetch(i.href,a)}})();const s={ship:{x:0,y:0,angle:0,velocityX:0,velocityY:0,turningLeft:!1,turningRight:!1,accelerating:!1,braking:!1},lasers:[],shooting:!1,lastBulletTime:0,score:0,ctx:null,canvas:null,asteroids:[],gameOver:!1};function j(){document.addEventListener("keydown",e=>{switch(e.code){case"ArrowUp":s.ship.accelerating=!0;break;case"ArrowLeft":s.ship.turningLeft=!0;break;case"ArrowRight":s.ship.turningRight=!0;break;case"Space":s.shooting=!0;break;case"ArrowDown":s.ship.braking=!0;break}}),document.addEventListener("keyup",e=>{switch(e.code){case"ArrowUp":s.ship.accelerating=!1;break;case"ArrowLeft":s.ship.turningLeft=!1;break;case"ArrowRight":s.ship.turningRight=!1;break;case"Space":s.shooting=!1;break;case"ArrowDown":s.ship.braking=!1;break}})}const r=40,C=400,O=.1,D=2,b=500,B=1.5*Math.PI,N=600,x=4,ee=120,Y=2e3,E=100,m=300,k=40,T=120,G=5;function S(e,t,o){e.x=(e.x+t)%t,e.y=(e.y+o)%o}function te(e){const{ship:t,canvas:o}=s;if(!o)return;t.turningLeft&&(t.angle-=B*e),t.turningRight&&(t.angle+=B*e),t.angle=(t.angle+Math.PI*2)%(Math.PI*2),t.accelerating&&(t.velocityX+=Math.sin(t.angle)*C*e,t.velocityY-=Math.cos(t.angle)*C*e),t.braking&&(t.velocityX*=1-D*e,t.velocityY*=1-D*e),t.velocityX*=1-O*e,t.velocityY*=1-O*e;const n=Math.hypot(t.velocityX,t.velocityY);n>b&&(t.velocityX=t.velocityX/n*b,t.velocityY=t.velocityY/n*b),t.x+=t.velocityX*e,t.y+=t.velocityY*e,S(t,o.width,o.height)}function U(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.angle);const o=[0,-r],n=[r*.7,r*.7],i=[-r*.7,r*.7];e.beginPath(),e.moveTo(o[0],o[1]),e.lineTo(n[0],n[1]),e.lineTo(i[0],i[1]),e.closePath();const a=e.createLinearGradient(0,-r,0,r*.7);if(a.addColorStop(0,"#e0e0ff"),a.addColorStop(.5,"#8888aa"),a.addColorStop(1,"#222244"),e.fillStyle=a,e.fill(),e.strokeStyle="#66ccff",e.lineWidth=3,e.stroke(),e.beginPath(),e.ellipse(0,-r*.5,r*.18,r*.28,0,0,Math.PI*2),e.fillStyle="#66ccff",e.globalAlpha=.7,e.fill(),e.globalAlpha=1,e.strokeStyle="#ffffff",e.lineWidth=1.2,e.stroke(),e.beginPath(),e.moveTo(-r*.7,r*.7),e.lineTo(-r*.5,r*.3),e.lineTo(-r*.3,r*.7),e.closePath(),e.fillStyle="#ff3366",e.fill(),e.beginPath(),e.moveTo(r*.7,r*.7),e.lineTo(r*.5,r*.3),e.lineTo(r*.3,r*.7),e.closePath(),e.fillStyle="#33ffd7",e.fill(),t.accelerating){const l=[-r*.4,r*.7],d=[0,r*1.3],c=[r*.4,r*.7];e.beginPath(),e.moveTo(l[0],l[1]),e.lineTo(d[0],d[1]),e.lineTo(c[0],c[1]),e.closePath(),e.fillStyle="orange",e.shadowColor="#ffcc00",e.shadowBlur=12,e.fill(),e.shadowBlur=0,e.strokeStyle="red",e.stroke()}if(t.braking){let l=function(u,p,Q){e.save(),e.translate(u,p),e.rotate(Q);const R=[-r*.18,0],P=[0,-r*.35],_=[r*.18,0];e.beginPath(),e.moveTo(R[0],R[1]),e.lineTo(P[0],P[1]),e.lineTo(_[0],_[1]),e.closePath(),e.fillStyle="#33aaff",e.shadowColor="#66ccff",e.shadowBlur=10,e.globalAlpha=.8,e.fill(),e.globalAlpha=1,e.shadowBlur=0,e.strokeStyle="#66ccff",e.stroke(),e.restore()},d=function([u,p]){return Math.atan2(p,u)+Math.PI/2};const c=[0,-r],h=[r*.7,r*.7],f=[-r*.7,r*.7];l(c[0],c[1],d(c)),l(h[0],h[1],d(h)),l(f[0],f[1],d(f))}e.restore()}const oe={laser1:typeof window<"u"?new window.Audio("sounds/laser1.wav"):null,laser2:typeof window<"u"?new window.Audio("sounds/laser2.wav"):null,explosion:typeof window<"u"?new window.Audio("sounds/explosion.wav"):null};let F=!1;function ne(e){F=e}function I(e){if(F)return;const t=oe[e];if(t){const o=t.cloneNode();o.volume=.5,o.play().catch(()=>{})}}function se(e){const{ship:t,lasers:o}=s,n=t.x+Math.sin(t.angle)*r,i=t.y-Math.cos(t.angle)*r;o.push({x:n,y:i,vx:Math.sin(t.angle)*N+t.velocityX,vy:-Math.cos(t.angle)*N+t.velocityY,angle:t.angle,createdAt:e}),I("laser1")}function ie(e,t){const{lasers:o,canvas:n}=s;if(n)for(let i=o.length-1;i>=0;i--){const a=o[i];a.x+=a.vx*t,a.y+=a.vy*t,S(a,n.width,n.height),e-a.createdAt>Y&&o.splice(i,1)}}function q(e,t){e.save();for(const o of t){let i=1-(performance.now()-o.createdAt)/Y;i<0&&(i=0),e.save(),e.globalAlpha=i,e.strokeStyle="#ff66ff",e.lineWidth=3;const a=18,l=o.x-Math.sin(o.angle)*a/2,d=o.y+Math.cos(o.angle)*a/2,c=o.x+Math.sin(o.angle)*a/2,h=o.y-Math.cos(o.angle)*a/2;e.beginPath(),e.moveTo(l,d),e.lineTo(c,h),e.stroke(),e.restore()}e.restore()}function g(e,t){return Math.random()*(t-e)+e}function v(e){const t=[],o=Math.floor(Math.random()*6)+8;for(let n=0;n<o;n++){const i=n/o*Math.PI*2,a=e/2*(.7+Math.random()*.5);t.push({x:Math.cos(i)*a,y:Math.sin(i)*a})}return t}function W(){const{canvas:e}=s;if(!e)return;s.asteroids=[];const t=r/2+m+40;for(let o=0;o<G;o++){const n=g(E,m),i=Math.random()*Math.PI*2,a=g(k,T);let l,d,c=0;do if(l=g(0,e.width),d=g(0,e.height),c++,c>100)break;while(H(l,d,s.ship.x,s.ship.y)<t);s.asteroids.push({x:l,y:d,velocityX:Math.sin(i)*a,velocityY:-Math.cos(i)*a,size:n,shape:v(n),rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.6})}}function H(e,t,o,n){const i=e-o,a=t-n;return Math.sqrt(i*i+a*a)}const ae=2.5,re=G;let A=0;function le(){const{canvas:e}=s;if(!e)return;const t=r/2+m+40,o=g(E,m),n=Math.random()*Math.PI*2,i=g(k,T);let a,l,d=0;do if(a=g(0,e.width),l=g(0,e.height),d++,d>100)break;while(H(a,l,s.ship.x,s.ship.y)<t);s.asteroids.push({x:a,y:l,velocityX:Math.sin(n)*i,velocityY:-Math.cos(n)*i,size:o,shape:v(o),rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.6})}function de(e){const{asteroids:t,canvas:o}=s;if(o){for(const n of t)n.x+=n.velocityX*e,n.y+=n.velocityY*e,n.rotation+=n.rotationSpeed*e,S(n,o.width,o.height);A+=e,A>=ae&&(A=0,t.length<re&&le())}}function V(e,t){e.save();for(const o of t){e.save(),e.translate(o.x,o.y),e.rotate(o.rotation||0);const n=e.createRadialGradient(0,0,o.size*.2,0,0,o.size*.6);n.addColorStop(0,"#e0e0e0"),n.addColorStop(.5,"#888888"),n.addColorStop(1,"#444444"),e.fillStyle=n,e.beginPath();const i=o.shape||v(o.size);e.moveTo(i[0].x,i[0].y);for(let a=1;a<i.length;a++)e.lineTo(i[a].x,i[a].y);e.closePath(),e.fill(),e.lineWidth=2,e.strokeStyle="#bbbbbb",e.stroke(),e.restore()}e.restore()}function ce(){const{lasers:e,asteroids:t}=s;for(let o=t.length-1;o>=0;o--){const n=t[o];for(let i=e.length-1;i>=0;i--){const a=e[i],l=n.x-a.x,d=n.y-a.y;if(Math.sqrt(l*l+d*d)<n.size/2+x){if(n.size>E*1.5)for(let h=0;h<2;h++){const f=n.size/2,u=Math.random()*Math.PI*2,p=g(k,T);t.push({x:n.x,y:n.y,velocityX:Math.sin(u)*p,velocityY:-Math.cos(u)*p,size:f,shape:v(f),rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.6})}t.splice(o,1),e.splice(i,1),s.score+=1,I("explosion");break}}}}function fe(){const{ship:e,asteroids:t}=s;for(let o=0;o<t.length;o++){const n=t[o],i=n.x-e.x,a=n.y-e.y;if(Math.sqrt(i*i+a*a)<n.size/2+r/2)return s.gameOver=!0,I("explosion"),!0}return!1}function $(e,t){e.save(),e.font="28px Arial",e.fillStyle="white",e.strokeStyle="black",e.lineWidth=3,e.textAlign="left",e.textBaseline="top",e.strokeText(`Score: ${t}`,20,20),e.fillText(`Score: ${t}`,20,20),e.restore()}const he=100,w=.5,X=1.5,z=5,ue=20;function Z(){const{canvas:e}=s;if(e){s.stars=[];for(let t=0;t<he;t++){const o=w+Math.random()*(X-w),n=(o-w)/(X-w),i=z+n*(ue-z);s.stars.push({x:Math.random()*e.width,y:Math.random()*e.height,radius:o,speed:i})}}}function pe(e){const{stars:t,canvas:o}=s;if(!(!t||!o))for(const n of t)n.y+=n.speed*e,S(n,o.width,o.height),n.y<.5&&(n.x=Math.random()*o.width)}function M(e){const{stars:t}=s;if(t){e.save(),e.fillStyle="white",e.globalAlpha=.7;for(const o of t)e.beginPath(),e.arc(o.x,o.y,o.radius,0,Math.PI*2),e.fill();e.globalAlpha=1,e.restore()}}let y=null;window.checkShipAsteroidCollision=fe;function ge(e){let t=document.getElementById("newGameBtn");t||(t=document.createElement("button"),t.id="newGameBtn",t.textContent="New Game",t.style.position="absolute",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.fontSize="2rem",t.style.padding="0.5em 2em",t.style.background="#222",t.style.color="#fff",t.style.border="2px solid #fff",t.style.borderRadius="10px",t.style.cursor="pointer",t.style.zIndex="20",t.addEventListener("click",()=>{t==null||t.remove(),K()}),document.body.appendChild(t)),typeof e=="number"?t.style.top=`${e}px`:t.style.top="60%"}function K(){const{canvas:e}=s;e&&(s.score=0,s.ship.x=e.width/2,s.ship.y=e.height/2,s.ship.angle=0,s.ship.velocityX=0,s.ship.velocityY=0,s.ship.turningLeft=!1,s.ship.turningRight=!1,s.ship.accelerating=!1,s.ship.braking=!1,s.lasers=[],s.asteroids=[],s.shooting=!1,s.lastBulletTime=0,s.gameOver=!1,W(),y=null,requestAnimationFrame(L))}function J(){const{ctx:e,canvas:t,ship:o,lasers:n,asteroids:i}=s;if(!e||!t)return;e.fillStyle="black",e.fillRect(0,0,t.width,t.height),typeof M=="function"&&M(e),$(e,s.score),V(e,i),q(e,n),U(e,o),e.save(),e.globalAlpha=.5,e.fillStyle="black",e.fillRect(0,0,t.width,t.height),e.globalAlpha=1;const a=t.height/2,l=140,d=a-l,c=a,h=a+l;let f=0;try{typeof window<"u"&&window.localStorage&&(f=parseInt(window.localStorage.getItem("asteroidsTopScore")||"0")||0)}catch{}if(s.score>f){f=s.score;try{typeof window<"u"&&window.localStorage&&window.localStorage.setItem("asteroidsTopScore",f.toString())}catch{}}e.font="bold 32px sans-serif",e.fillStyle="#fff",e.textAlign="center",e.fillText(`Top Score: ${f}`,t.width/2,d),e.font="bold 64px sans-serif",e.fillStyle="red",e.textAlign="center",e.fillText("GAME OVER",t.width/2,c),e.restore(),ge(h),window._gameOverSpaceListener||(window._gameOverSpaceListener=function(u){if(s.gameOver&&(u.code==="Space"||u.key===" ")){const p=document.getElementById("newGameBtn");p&&p.remove(),K(),window._gameOverSpaceListener&&(window.removeEventListener("keydown",window._gameOverSpaceListener),window._gameOverSpaceListener=void 0)}},window.addEventListener("keydown",window._gameOverSpaceListener))}function L(e){y||(y=e);const t=(e-y)/1e3;y=e;const{ctx:o,canvas:n,ship:i,lasers:a,asteroids:l}=s;if(!(!o||!n)){if(o.fillStyle="black",o.fillRect(0,0,n.width,n.height),pe(t),M(o),te(t),s.shooting&&(!s.lastBulletTime||e-s.lastBulletTime>ee)&&(se(e),s.lastBulletTime=e),ie(e,t),de(t),ce(),window.checkShipAsteroidCollision&&window.checkShipAsteroidCollision()){J();return}$(o,s.score),V(o,l),q(o,a),U(o,i),requestAnimationFrame(L)}}function ye(){const e=document.getElementById("gameCanvas");e&&(s.canvas=e,s.ctx=e.getContext("2d"),s.ctx&&(s.ship.x=e.width/2,s.ship.y=e.height/2,W(),j(),Z(),requestAnimationFrame(L)))}function we(){const e=document.getElementById("gameCanvas");e&&(e.width=window.innerWidth,e.height=window.innerHeight,s.canvas!==e&&(s.canvas=e,s.ctx=e.getContext("2d")),s.stars&&Z(),s.gameOver&&J())}document.addEventListener("DOMContentLoaded",ye);window.addEventListener("resize",we);window.addEventListener("DOMContentLoaded",()=>{const e=document.createElement("button");e.textContent="🔊",e.style.position="absolute",e.style.top="10px",e.style.right="10px",e.style.zIndex="10",e.style.fontSize="2rem",e.style.background="rgba(0,0,0,0.5)",e.style.color="white",e.style.border="none",e.style.borderRadius="8px",e.style.cursor="pointer",e.setAttribute("aria-label","Mute/Unmute sound"),e.setAttribute("tabindex","0");let t=!1;e.addEventListener("click",n=>{t=!t,ne(t),e.textContent=t?"🔇":"🔊",e.blur(),n.preventDefault()}),e.addEventListener("keydown",n=>{(n.code==="Space"||n.code==="Enter")&&n.preventDefault()}),document.body.appendChild(e);let o=document.getElementById("githubRepoLink");o||(o=document.createElement("a"),o.id="githubRepoLink",o.href="https://github.com/MatthewLavine/asteroids",o.target="_blank",o.rel="noopener noreferrer",o.style.position="fixed",o.style.left="16px",o.style.bottom="16px",o.style.background="rgba(0,0,0,0.7)",o.style.color="#fff",o.style.padding="8px",o.style.borderRadius="8px",o.style.fontSize="1.1rem",o.style.textDecoration="none",o.style.zIndex="30",o.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",o.style.transition="background 0.2s",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.width="44px",o.style.height="44px",o.innerHTML=`
      <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-label="GitHub" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.987 1.029-2.687-.103-.254-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.396.1 2.65.64.7 1.028 1.594 1.028 2.687 0 3.847-2.337 4.695-4.566 4.944.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.749 0 .268.18.579.688.481C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"/>
      </svg>
    `,o.addEventListener("mouseover",()=>{o.style.background="#333"}),o.addEventListener("mouseout",()=>{o.style.background="rgba(0,0,0,0.7)"}),o.setAttribute("aria-label","View on GitHub"),document.body.appendChild(o))});
